<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Edit Waialnd Status</title>
  <meta name="description" content="Edit statuses (admin)">
  <link rel="icon" href="/images/status-icon.png">
  <style>
    :root{--bg:#071127;--card:#071427;--muted:#9aa4b2;--accent:#3b82f6;--ok:#16a34a;--warn:#f59e0b;--down:#ef4444}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;color:#e6eef6;background:linear-gradient(180deg,#031021,#071127);display:flex;align-items:center;justify-content:center}
    .wrap{width:100%;max-width:980px;padding:20px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:18px;border-radius:12px;border:1px solid rgba(255,255,255,0.03)}
    h1{margin:0 0 8px 0}
    p.sub{color:var(--muted);margin:0 0 14px 0}
    .login{display:flex;gap:8px;margin-bottom:14px}
    input[type="password"]{flex:1;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:#e6eef6}
    button{padding:10px 12px;border-radius:8px;border:none;background:var(--accent);color:#041224;cursor:pointer;font-weight:700}
    .editor{display:none;margin-top:12px}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(46%,1fr));gap:10px}
    .row{display:flex;align-items:center;gap:8px;padding:10px;border-radius:8px;background:rgba(255,255,255,0.01);border:1px solid rgba(255,255,255,0.02)}
    .row .name{flex:1;font-weight:600}
    select{padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:#e6eef6}
    .actions{display:flex;gap:8px;margin-top:12px;justify-content:flex-end}
    .btn-secondary{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:10px;border-radius:8px;color:var(--muted)}
    .note{color:var(--muted);font-size:0.9rem;margin-top:10px}
    @media (max-width:720px){
      .grid{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Edit Waialnd Status</h1>
      <p class="sub">Please login to edit the status page. (Demo password stored client-side)</p>

      <div class="login" id="loginBox">
        <input id="pwd" type="password" placeholder="Enter admin password">
        <button id="loginBtn">Login</button>
      </div>

      <div id="editor" class="editor">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
          <div>
            <strong>Admin Editor</strong>
            <div class="note">Change each item's status then Save. Status changes are saved to localStorage (client-side).</div>
          </div>
          <div>
            <button class="btn-secondary" id="logoutBtn">Logout</button>
          </div>
        </div>

        <div id="editorGrid" class="grid"></div>

        <div class="actions">
          <button id="saveBtn" style="background:#16a34a;color:#05260f;padding:10px 14px;border-radius:8px;border:none;font-weight:700">Save & Return</button>
        </div>
      </div>

      <p class="note">Note: For production, replace client-only storage with a server API and secure authentication.</p>
    </div>
  </div>

  <script>
    const ADMIN_PWD = 'wailandadmin'; // as requested (client-side)
    const loginBox = document.getElementById('loginBox');
    const editor = document.getElementById('editor');
    const pwdInput = document.getElementById('pwd');

    function loadStatuses(){
      const raw = localStorage.getItem('wailand_statuses');
      if(!raw){
        // default same as main
        const defaults = {
          "Website":"operational","Bots":"operational","Host":"operational","Database":"operational","API":"operational",
          "Services":"operational","Network":"operational","System":"operational","Application":"operational","Infrastructure":"operational",
          "Security":"operational","Monitoring":"operational","Logging":"operational","Backup":"operational","Deployment":"operational",
          "Maintenance":"operational","Update":"operational","Performance":"operational","Availability":"operational","Reliability":"operational",
          "Scalability":"operational","Efficiency":"operational","Compatibility":"operational","Integration":"operational","Documentation":"operational",
          "Support":"operational","Compliance":"operational","Audit":"operational","Recovery":"operational","Disaster Recovery":"operational",
          "Business Continuity":"operational","Incident Management":"operational","Change Management":"operational","Configuration Management":"operational",
          "Service Level Agreement":"operational","Quality Assurance":"operational","Risk Management":"operational","Resource Management":"operational",
          "Project Management":"operational","Team Management":"operational","Communication":"operational","Collaboration":"operational","Productivity":"operational",
          "Innovation":"operational","Growth":"operational","Stability":"operational","Sustainability":"operational","Future":"operational","Legacy":"operational"
        };
        localStorage.setItem('wailand_statuses', JSON.stringify(defaults));
        return defaults;
      }
      try{return JSON.parse(raw);}catch(e){return {};}
    }

    function buildEditor(){
      const data = loadStatuses();
      const grid = document.getElementById('editorGrid');
      grid.innerHTML = '';
      Object.keys(data).forEach(key=>{
        const row = document.createElement('div');
        row.className = 'row';
        const name = document.createElement('div');
        name.className = 'name';
        name.textContent = key;
        const sel = document.createElement('select');
        sel.innerHTML = `
          <option value="operational">Operational</option>
          <option value="degraded">Degraded</option>
          <option value="down">Outage</option>
          <option value="maintenance">Maintenance</option>
        `;
        sel.value = data[key] || 'operational';
        sel.dataset.key = key;
        row.appendChild(name);
        row.appendChild(sel);
        grid.appendChild(row);
      });
    }

    document.getElementById('loginBtn').addEventListener('click', ()=>{
      const val = pwdInput.value;
      if(val === ADMIN_PWD){
        // show editor
        loginBox.style.display = 'none';
        editor.style.display = 'block';
        buildEditor();
      } else {
        alert('Incorrect password');
      }
    });

    // also allow Enter key
    pwdInput.addEventListener('keyup', e=>{
      if(e.key === 'Enter') document.getElementById('loginBtn').click();
    });

    document.getElementById('saveBtn').addEventListener('click', ()=>{
      const selects = document.querySelectorAll('#editorGrid select');
      const newObj = {};
      selects.forEach(s=>{
        newObj[s.dataset.key] = s.value;
      });
      localStorage.setItem('wailand_statuses', JSON.stringify(newObj));
      localStorage.setItem('wailand_status_last_updated', new Date().toISOString());
      // redirect back to main page (adjust path if different on your server)
      window.location.href = '/status/wailand-status.html';
    });

    document.getElementById('logoutBtn').addEventListener('click', ()=>{
      editor.style.display='none';
      loginBox.style.display='flex';
      pwdInput.value='';
    });

    // if you want auto-show editor when visiting with ?edit=1 and password in hash (not recommended),
    // you could implement that here; for now we require manual login.
  </script>
</body>
</html>
