<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wailand - Complete Quests, Earn Coins</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #5865F2;
            --secondary: #57F287;
            --dark: #23272A;
            --light: #F6F6F6;
            --danger: #ED4245;
            --warning: #FEE75C;
            --success: #57F287;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #36393f;
            color: var(--light);
            min-height: 100vh;
            padding-bottom: 60px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 30px;
            background-color: var(--dark);
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            font-size: 2.5rem;
            color: var(--secondary);
            margin-bottom: 10px;
        }
        
        h2 {
            font-size: 1.8rem;
            margin-bottom: 20px;
            color: var(--secondary);
        }
        
        .user-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: var(--dark);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .coins-display {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--warning);
        }
        
        .buy-button {
            background-color: var(--success);
            color: var(--dark);
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .buy-button:hover {
            background-color: #45d173;
            transform: translateY(-2px);
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: var(--dark);
            padding: 30px;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .modal h3 {
            margin-bottom: 20px;
            text-align: center;
            color: var(--secondary);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .form-group input {
            width: 100%;
            padding: 12px;
            border-radius: 5px;
            border: 1px solid #4f545c;
            background-color: #40444b;
            color: var(--light);
        }
        
        .button-group {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #4752c4;
        }
        
        .btn-secondary {
            background-color: #4f545c;
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #5d6269;
        }
        
        .btn-success {
            background-color: var(--success);
            color: var(--dark);
        }
        
        .btn-success:hover {
            background-color: #45d173;
        }
        
        .btn-danger {
            background-color: var(--danger);
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #c03537;
        }
        
        .quests-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .quest-card {
            background-color: var(--dark);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
        }
        
        .quest-card:hover {
            transform: translateY(-5px);
        }
        
        .quest-title {
            font-size: 1.4rem;
            margin-bottom: 10px;
            color: var(--secondary);
        }
        
        .quest-details {
            margin-bottom: 15px;
            color: #b9bbbe;
        }
        
        .quest-reward {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
        }
        
        .reward-amount {
            font-weight: bold;
            color: var(--warning);
        }
        
        .admin-icon {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background-color: var(--primary);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 100;
        }
        
        .admin-icon i {
            font-size: 24px;
            color: white;
        }
        
        .admin-panel {
            display: none;
            background-color: var(--dark);
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .admin-quests {
            margin-top: 20px;
        }
        
        .admin-quest-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background-color: #40444b;
            border-radius: 8px;
            margin-bottom: 10px;
        }
        
        .timer-modal {
            text-align: center;
        }
        
        .timer-display {
            font-size: 3rem;
            font-weight: bold;
            color: var(--warning);
            margin: 20px 0;
        }
        
        .message {
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .message-success {
            background-color: rgba(87, 242, 135, 0.2);
            border: 1px solid var(--success);
        }
        
        .message-error {
            background-color: rgba(237, 66, 69, 0.2);
            border: 1px solid var(--danger);
        }
        
        @media (max-width: 768px) {
            .quests-grid {
                grid-template-columns: 1fr;
            }
            
            .user-info {
                flex-direction: column;
                gap: 15px;
            }
            
            .button-group {
                flex-direction: column;
                gap: 10px;
            }
            
            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Wailand</h1>
            <p>Complete quests, earn coins, and unlock rewards!</p>
        </header>
        
        <div id="userSetup">
            <div class="modal" style="display: flex;">
                <div class="modal-content">
                    <h3>Enter Your Discord ID</h3>
                    <div class="form-group">
                        <label for="discordId">Discord ID</label>
                        <input type="text" id="discordId" placeholder="e.g., YourDiscordName#1234">
                    </div>
                    <button class="btn btn-primary" id="saveUser">Start Earning Coins</button>
                </div>
            </div>
        </div>
        
        <div id="mainContent" style="display: none;">
            <div class="user-info">
                <div>
                    <h3>Welcome, <span id="userName">User</span>!</h3>
                    <div class="coins-display">Coins: <span id="coinsBalance">0</span></div>
                </div>
                <button class="buy-button" id="buyButton">Buy with Coins</button>
            </div>
            
            <h2>Available Quests</h2>
            <div id="messageArea"></div>
            
            <div class="quests-grid" id="questsContainer">
                <!-- Quests will be loaded here -->
            </div>
            
            <div class="admin-panel" id="adminPanel">
                <h2>Admin Panel</h2>
                <div class="form-group">
                    <label for="questTitle">Quest Title</label>
                    <input type="text" id="questTitle">
                </div>
                <div class="form-group">
                    <label for="questLink">Quest Link</label>
                    <input type="text" id="questLink">
                </div>
                <div class="form-group">
                    <label for="questReward">Coin Reward</label>
                    <input type="number" id="questReward">
                </div>
                <div class="form-group">
                    <label for="questDuration">Required Duration (seconds)</label>
                    <input type="number" id="questDuration">
                </div>
                <button class="btn btn-success" id="addQuest">Add Quest</button>
                
                <div class="admin-quests" id="adminQuests">
                    <!-- Admin quest list will be loaded here -->
                </div>
            </div>
        </div>
        
        <div class="modal" id="timerModal">
            <div class="modal-content timer-modal">
                <h3>Quest in Progress</h3>
                <p>Stay on the quest page for the full duration to earn your reward!</p>
                <div class="timer-display" id="timerDisplay">00:00</div>
                <p id="earlyWarning" style="color: var(--danger); display: none;">
                    Warning: Leaving early will cancel the reward!
                </p>
                <button class="btn btn-danger" id="closeQuest">Close Quest</button>
            </div>
        </div>
    </div>
    
    <div class="admin-icon" id="adminIcon">
        <i class="fas fa-lock"></i>
    </div>

    <script>
        // Data storage
        let userData = {
            discordId: '',
            coins: 0,
            completedQuests: []
        };
        
        let quests = [];
        let currentQuest = null;
        let questTimer = null;
        let timeRemaining = 0;
        
        // DOM Elements
        const userSetup = document.getElementById('userSetup');
        const mainContent = document.getElementById('mainContent');
        const discordIdInput = document.getElementById('discordId');
        const saveUserButton = document.getElementById('saveUser');
        const userNameSpan = document.getElementById('userName');
        const coinsBalanceSpan = document.getElementById('coinsBalance');
        const buyButton = document.getElementById('buyButton');
        const questsContainer = document.getElementById('questsContainer');
        const adminIcon = document.getElementById('adminIcon');
        const adminPanel = document.getElementById('adminPanel');
        const timerModal = document.getElementById('timerModal');
        const timerDisplay = document.getElementById('timerDisplay');
        const closeQuestButton = document.getElementById('closeQuest');
        const messageArea = document.getElementById('messageArea');
        const adminQuests = document.getElementById('adminQuests');
        
        // Predefined redirect link for buying with coins
        const BUY_REDIRECT_LINK = "https://example.com/rewards";
        
        // Initialize the application
        function init() {
            loadQuests();
            loadUserData();
            setupEventListeners();
        }
        
        // Set up event listeners
        function setupEventListeners() {
            saveUserButton.addEventListener('click', saveUser);
            buyButton.addEventListener('click', redirectToBuy);
            adminIcon.addEventListener('click', showAdminLogin);
            closeQuestButton.addEventListener('click', closeQuest);
            
            // Admin panel event listeners
            document.getElementById('addQuest').addEventListener('click', addQuest);
        }
        
        // Load user data from localStorage
        function loadUserData() {
            const savedData = localStorage.getItem('wailandUserData');
            if (savedData) {
                userData = JSON.parse(savedData);
                userNameSpan.textContent = userData.discordId;
                coinsBalanceSpan.textContent = userData.coins;
                userSetup.style.display = 'none';
                mainContent.style.display = 'block';
            }
        }
        
        // Save user data to localStorage
        function saveUserData() {
            localStorage.setItem('wailandUserData', JSON.stringify(userData));
            coinsBalanceSpan.textContent = userData.coins;
        }
        
        // Load quests from localStorage
        function loadQuests() {
            const savedQuests = localStorage.getItem('wailandQuests');
            if (savedQuests) {
                quests = JSON.parse(savedQuests);
                renderQuests();
                renderAdminQuests();
            } else {
                // Default quests if none exist
                quests = [
                    {
                        id: 1,
                        title: "Visit Discord",
                        link: "https://discord.com",
                        reward: 50,
                        duration: 30
                    },
                    {
                        id: 2,
                        title: "Check Google",
                        link: "https://google.com",
                        reward: 25,
                        duration: 20
                    }
                ];
                saveQuests();
                renderQuests();
                renderAdminQuests();
            }
        }
        
        // Save quests to localStorage
        function saveQuests() {
            localStorage.setItem('wailandQuests', JSON.stringify(quests));
        }
        
        // Render quests to the UI
        function renderQuests() {
            questsContainer.innerHTML = '';
            
            quests.forEach(quest => {
                const isCompleted = userData.completedQuests.includes(quest.id);
                
                const questCard = document.createElement('div');
                questCard.className = 'quest-card';
                questCard.innerHTML = `
                    <h3 class="quest-title">${quest.title}</h3>
                    <div class="quest-details">
                        <p>Stay for: ${quest.duration} seconds</p>
                        <p>Reward: ${quest.reward} coins</p>
                    </div>
                    <div class="quest-reward">
                        <span class="reward-amount">${isCompleted ? 'Completed âœ“' : `${quest.reward} coins`}</span>
                        <button class="btn btn-primary" data-id="${quest.id}" ${isCompleted ? 'disabled' : ''}>
                            ${isCompleted ? 'Completed' : 'Start Quest'}
                        </button>
                    </div>
                `;
                
                if (!isCompleted) {
                    const startButton = questCard.querySelector('button');
                    startButton.addEventListener('click', () => startQuest(quest));
                }
                
                questsContainer.appendChild(questCard);
            });
        }
        
        // Render admin quests list
        function renderAdminQuests() {
            adminQuests.innerHTML = '';
            
            quests.forEach(quest => {
                const questItem = document.createElement('div');
                questItem.className = 'admin-quest-item';
                questItem.innerHTML = `
                    <div>
                        <strong>${quest.title}</strong> - ${quest.reward} coins (${quest.duration}s)
                    </div>
                    <div>
                        <button class="btn btn-danger" data-id="${quest.id}">Delete</button>
                    </div>
                `;
                
                const deleteButton = questItem.querySelector('button');
                deleteButton.addEventListener('click', () => deleteQuest(quest.id));
                
                adminQuests.appendChild(questItem);
            });
        }
        
        // Save user information
        function saveUser() {
            const discordId = discordIdInput.value.trim();
            if (!discordId) {
                showMessage('Please enter your Discord ID', 'error');
                return;
            }
            
            userData.discordId = discordId;
            userData.coins = userData.coins || 0;
            userData.completedQuests = userData.completedQuests || [];
            
            saveUserData();
            userNameSpan.textContent = userData.discordId;
            coinsBalanceSpan.textContent = userData.coins;
            
            userSetup.style.display = 'none';
            mainContent.style.display = 'block';
            
            showMessage('Welcome to Wailand! Start completing quests to earn coins.', 'success');
        }
        
        // Start a quest
        function startQuest(quest) {
            if (userData.completedQuests.includes(quest.id)) {
                showMessage('You have already completed this quest!', 'error');
                return;
            }
            
            currentQuest = quest;
            timeRemaining = quest.duration;
            
            // Open the quest link in a new tab
            window.open(quest.link, '_blank');
            
            // Show the timer modal
            updateTimerDisplay();
            timerModal.style.display = 'flex';
            
            // Start the timer
            questTimer = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    completeQuest();
                }
            }, 1000);
        }
        
        // Update the timer display
        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // Show warning when time is running out
            if (timeRemaining < 10) {
                timerDisplay.style.color = 'var(--danger)';
            }
        }
        
        // Complete the current quest
        function completeQuest() {
            clearInterval(questTimer);
            
            userData.coins += currentQuest.reward;
            userData.completedQuests.push(currentQuest.id);
            
            saveUserData();
            renderQuests();
            
            timerModal.style.display = 'none';
            showMessage(`Quest completed! You earned ${currentQuest.reward} coins.`, 'success');
            
            currentQuest = null;
        }
        
        // Close the quest early
        function closeQuest() {
            clearInterval(questTimer);
            
            if (timeRemaining > 0) {
                showMessage('Quest canceled. You did not stay long enough to earn rewards.', 'error');
            }
            
            timerModal.style.display = 'none';
            currentQuest = null;
        }
        
        // Redirect to buy page
        function redirectToBuy() {
            if (userData.coins < 10) {
                showMessage('You need at least 10 coins to make a purchase', 'error');
                return;
            }
            
            window.location.href = BUY_REDIRECT_LINK;
        }
        
        // Show admin login
        function showAdminLogin() {
            const password = prompt('Enter admin password:');
            if (password === 'wailandadmin') {
                adminPanel.style.display = 'block';
                showMessage('Admin panel unlocked', 'success');
            } else {
                showMessage('Incorrect password', 'error');
            }
        }
        
        // Add a new quest
        function addQuest() {
            const title = document.getElementById('questTitle').value.trim();
            const link = document.getElementById('questLink').value.trim();
            const reward = parseInt(document.getElementById('questReward').value);
            const duration = parseInt(document.getElementById('questDuration').value);
            
            if (!title || !link || isNaN(reward) || isNaN(duration)) {
                showMessage('Please fill all fields with valid data', 'error');
                return;
            }
            
            const newQuest = {
                id: Date.now(), // Unique ID
                title,
                link,
                reward,
                duration
            };
            
            quests.push(newQuest);
            saveQuests();
            renderQuests();
            renderAdminQuests();
            
            // Clear the form
            document.getElementById('questTitle').value = '';
            document.getElementById('questLink').value = '';
            document.getElementById('questReward').value = '';
            document.getElementById('questDuration').value = '';
            
            showMessage('Quest added successfully', 'success');
        }
        
        // Delete a quest
        function deleteQuest(id) {
            quests = quests.filter(quest => quest.id !== id);
            saveQuests();
            renderQuests();
            renderAdminQuests();
            showMessage('Quest deleted successfully', 'success');
        }
        
        // Show message to user
        function showMessage(text, type) {
            messageArea.innerHTML = `<div class="message message-${type}">${text}</div>`;
            
            // Auto hide after 5 seconds
            setTimeout(() => {
                messageArea.innerHTML = '';
            }, 5000);
        }
        
        // Initialize the app
        init();
    </script>
</body>
</html>